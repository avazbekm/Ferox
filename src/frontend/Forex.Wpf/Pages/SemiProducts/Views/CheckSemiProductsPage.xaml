<Page x:Class="Forex.Wpf.Pages.SemiProducts.Views.CheckSemiProductsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
      xmlns:vm="clr-namespace:Forex.Wpf.Pages.SemiProducts.ViewModels"
      mc:Ignorable="d"
      d:DesignHeight="450"
      d:DesignWidth="800"
      Title="CheckSemiProductsPage">
    <Border CornerRadius="4"
            Background="{StaticResource PrimaryBackground}">


        <Grid Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <!--== Jadval ==-->
                <RowDefinition Height="Auto" />
                <!--== Tugma ==-->
            </Grid.RowDefinitions>

            <Border CornerRadius="4"
                    Background="#EEE"
                    BorderBrush="Gray"
                    BorderThickness="1"
                    Grid.Row="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <!-- Header -->
                        <RowDefinition Height="*" />
                        <!-- Content -->
                        <RowDefinition Height="Auto" />
                        <!-- Footer -->
                    </Grid.RowDefinitions>
                    <Border BorderThickness="0 0 0 1"
                            Padding="2"
                            BorderBrush="Gray">
                        <Grid Margin="15 0"
                              Background="#EEE">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition MinWidth="100"
                                                  MaxWidth="200" />
                                <!--== Surat ==-->

                                <ColumnDefinition Width="*" />
                                <!--== Qolgan ma'lumotlar ==-->
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="Surat"
                                       FontWeight="Bold"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center" />

                            <Grid Grid.Column="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition  Width="100" />
                                    <!--== O'lchami ==-->

                                    <ColumnDefinition Width="*" />
                                    <!--== Qolgan ma'lumotlar ==-->
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="O'lchami"
                                           FontWeight="Bold"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Center" />

                                <Grid Grid.Column="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <!--== Soni ==-->

                                        <ColumnDefinition Width="*" />
                                        <!--== Birligi ==-->

                                        <ColumnDefinition Width="*" />
                                        <!--== Birlik narxi ==-->

                                        <ColumnDefinition Width="*" />
                                        <!--== Jami summa ==-->
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Text="Soni"
                                               FontWeight="Bold"
                                               HorizontalAlignment="Center" />

                                    <TextBlock Text="Birligi"
                                               FontWeight="Bold"
                                               Grid.Column="1"
                                               HorizontalAlignment="Center" />

                                    <TextBlock Text="Birlik narxi"
                                               FontWeight="Bold"
                                               Grid.Column="2"
                                               HorizontalAlignment="Center" />

                                    <TextBlock Text="Jami summa"
                                               FontWeight="Bold"
                                               Grid.Column="3"
                                               HorizontalAlignment="Center" />
                                </Grid>
                            </Grid>
                        </Grid>
                    </Border>

                    <ScrollViewer VerticalScrollBarVisibility="Auto"
                                  Grid.Row="1"
                                  IsTabStop="False"
                                  Focusable="False">
                        <StackPanel Grid.Row="1"
                                    Orientation="Vertical"
                                    Margin="0"
                                    Focusable="False">
                            <ItemsControl ItemsSource="{Binding Products}"
                                          Grid.Row="1"
                                          IsTabStop="False"
                                          Focusable="False">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border BorderThickness="1"
                                                BorderBrush="Gray"
                                                Margin="5"
                                                Padding="5"
                                                Focusable="False">
                                            <Grid Focusable="False">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition MinWidth="100"
                                                                      MaxWidth="200" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>

                                                <!-- Image -->
                                                <Image Source="{Binding Image, Converter={StaticResource ImageFallbackConverter}}"
                                                       HorizontalAlignment="Center" />

                                                <!-- Types -->
                                                <DataGrid ItemsSource="{Binding Types}"
                                                          Grid.Column="1"
                                                          AutoGenerateColumns="False"
                                                          HeadersVisibility="None"
                                                          CanUserAddRows="False"
                                                          IsReadOnly="True"
                                                          IsTabStop="False"
                                                          IsHitTestVisible="False"
                                                          MinHeight="50"
                                                          GridLinesVisibility="All">

                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Binding="{Binding Type}"
                                                                            Width="100">

                                                            <DataGridTextColumn.ElementStyle>
                                                                <Style TargetType="TextBlock">
                                                                    <Setter Property="VerticalAlignment"
                                                                            Value="Center" />
                                                                    <Setter Property="HorizontalAlignment"
                                                                            Value="Center" />
                                                                </Style>
                                                            </DataGridTextColumn.ElementStyle>
                                                        </DataGridTextColumn>

                                                        <DataGridTemplateColumn Width="*">
                                                            <DataGridTemplateColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <DataGrid ItemsSource="{Binding Items}"
                                                                              AutoGenerateColumns="False"
                                                                              HeadersVisibility="None"
                                                                              CanUserAddRows="False"
                                                                              IsReadOnly="True"
                                                                              IsTabStop="False"
                                                                              GridLinesVisibility="None">
                                                                        <DataGrid.Resources>
                                                                            <Style TargetType="TextBlock"
                                                                                   x:Key="CenteredTextBlockStyle">
                                                                                <Setter Property="HorizontalAlignment"
                                                                                        Value="Center" />
                                                                                <Setter Property="VerticalAlignment"
                                                                                        Value="Center" />
                                                                            </Style>
                                                                        </DataGrid.Resources>

                                                                        <DataGrid.Columns>
                                                                            <DataGridTextColumn Binding="{Binding SemiProduct.Quantity}"
                                                                                                ElementStyle="{StaticResource CenteredTextBlockStyle}"
                                                                                                Width="*" />
                                                                            <DataGridTextColumn Binding="{Binding SemiProduct.Measure.Name}"
                                                                                                ElementStyle="{StaticResource CenteredTextBlockStyle}"
                                                                                                Width="*" />
                                                                            <DataGridTextColumn Binding="{Binding SemiProduct.CostPrice, StringFormat={}{0:N2}}"
                                                                                                ElementStyle="{StaticResource CenteredTextBlockStyle}"
                                                                                                Width="*" />
                                                                            <DataGridTextColumn Binding="{Binding SemiProduct.TotalAmount, StringFormat={}{0:N2}}"
                                                                                                ElementStyle="{StaticResource CenteredTextBlockStyle}"
                                                                                                Width="*" />
                                                                        </DataGrid.Columns>

                                                                    </DataGrid>
                                                                </DataTemplate>
                                                            </DataGridTemplateColumn.CellTemplate>
                                                        </DataGridTemplateColumn>
                                                    </DataGrid.Columns>

                                                </DataGrid>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>

                            <Border BorderThickness="1" BorderBrush="Gray" Margin="5" Padding="5">
                                <ItemsControl ItemsSource="{Binding IndependentSemiProducts}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border BorderBrush="LightGray"
                                                BorderThickness="0 0 0 1"
                                                Padding="5 3">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition SharedSizeGroup="colImage"
                                                                      MinWidth="100"
                                                                      MaxWidth="200" />
                                                    <ColumnDefinition SharedSizeGroup="colSize"
                                                                      Width="150" />
                                                    <ColumnDefinition SharedSizeGroup="colQty"
                                                                      Width="*" />
                                                    <ColumnDefinition SharedSizeGroup="colMeasure"
                                                                      Width="*" />
                                                    <ColumnDefinition SharedSizeGroup="colPrice"
                                                                      Width="*" />
                                                    <ColumnDefinition SharedSizeGroup="colTotal"
                                                                      Width="*" />
                                                </Grid.ColumnDefinitions>

                                                <!-- Surat -->
                                                <Image Source="{Binding Image, Converter={StaticResource ImageFallbackConverter}}"
                                                       MaxHeight="50"
                                                       HorizontalAlignment="Center" />

                                                <!-- O‘lchami -->
                                                <TextBlock Text="{Binding Size}"
                                                           Grid.Column="1"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center" />

                                                <!-- Soni -->
                                                <TextBlock Text="{Binding Quantity}"
                                                           Grid.Column="2"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center" />

                                                <!-- Birligi -->
                                                <TextBlock Text="{Binding Measure.Name}"
                                                           Grid.Column="3"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center" />

                                                <!-- Narxi -->
                                                <TextBlock Text="{Binding CostPrice, StringFormat={}{0:N2}}"
                                                           Grid.Column="4"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center" />

                                                <!-- Jami summa -->
                                                <TextBlock Text="{Binding TotalAmount, StringFormat={}{0:N2}}"
                                                           Grid.Column="5"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center" />
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>

                    <Border BorderThickness="0 1 0 0"
                            Grid.Row="2"
                            BorderBrush="Gray">

                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Right">

                            <TextBlock Text="Ja'mi:  "
                                       FontWeight="Bold"
                                       HorizontalAlignment="Right" />

                            <TextBlock Text="{Binding Invoice.TotalAmount}"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Right" />

                            <TextBlock Text="{Binding Invoice.Currency.Code}"
                                       FontWeight="Bold"
                                       Margin="20 0"
                                       HorizontalAlignment="Right" />

                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <!--  SUBMIT BUTTON  -->
            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Right"
                        Margin="0 10 0 0"
                        Grid.Row="2">

                <Button x:Name="submitButton"
                        md:ElevationAssist.Elevation="Dp24"
                        Background="{StaticResource SuccessButtonBackground}"
                        BorderBrush="{StaticResource SuccessButtonBorder}"
                        Command="{Binding SubmitCommand}"
                        Content="Yuborish"
                        Foreground="{StaticResource SuccessButtonForeground}" />
            </StackPanel>

        </Grid>
    </Border>
</Page>
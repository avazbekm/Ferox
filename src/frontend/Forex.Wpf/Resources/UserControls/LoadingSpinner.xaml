<UserControl x:Class="Forex.Wpf.Resources.UserControls.LoadingSpinner"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Width="50"
             Height="50"
             Opacity="0"
             Visibility="Visible">
    <UserControl.Style>
        <Style TargetType="UserControl">
            <Style.Triggers>
                <!-- Spinner ko‘rinadi -->
                <DataTrigger Binding="{Binding IsActive, RelativeSource={RelativeSource AncestorType=UserControl}}"
                             Value="True">
                    <DataTrigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard FillBehavior="Stop">
                                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                 From="0"
                                                 To="1"
                                                 Duration="0:0:0.3" />
                                <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility">
                                    <DiscreteObjectKeyFrame Value="{x:Static Visibility.Visible}"
                                                            KeyTime="0:0:0" />
                                </ObjectAnimationUsingKeyFrames>
                            </Storyboard>
                        </BeginStoryboard>
                    </DataTrigger.EnterActions>
                </DataTrigger>

                <!-- Spinner yo‘qoladi -->
                <DataTrigger Binding="{Binding IsActive, RelativeSource={RelativeSource AncestorType=UserControl}}"
                             Value="False">
                    <DataTrigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard FillBehavior="Stop">
                                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0"
                                                 Duration="0:0:0.3" />
                                <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility"
                                                               BeginTime="0:0:0.3">
                                    <DiscreteObjectKeyFrame Value="{x:Static Visibility.Collapsed}" />
                                </ObjectAnimationUsingKeyFrames>
                            </Storyboard>
                        </BeginStoryboard>
                    </DataTrigger.EnterActions>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </UserControl.Style>

    <!-- Spinner animatsiyasi -->
    <Ellipse Width="40"
             Height="40"
             Stroke="Gray"
             StrokeThickness="4"
             StrokeDashArray="2 6"
             StrokeStartLineCap="Round">
        <Ellipse.RenderTransform>
            <RotateTransform x:Name="SpinnerRotate"
                             Angle="0"
                             CenterX="20"
                             CenterY="20" />
        </Ellipse.RenderTransform>
        <Ellipse.Triggers>
            <EventTrigger RoutedEvent="Loaded">
                <BeginStoryboard>
                    <Storyboard RepeatBehavior="Forever">
                        <DoubleAnimation Storyboard.TargetName="SpinnerRotate"
                                         Storyboard.TargetProperty="Angle"
                                         From="0"
                                         To="360"
                                         Duration="0:0:1" />
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </Ellipse.Triggers>
    </Ellipse>
</UserControl>

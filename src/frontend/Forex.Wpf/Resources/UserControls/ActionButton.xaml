<UserControl x:Class="Forex.Wpf.Resources.UserControls.ActionButton"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Width="Auto"
             Height="Auto"
             MinWidth="24"
             MinHeight="24">
    <Grid>
        <!-- 3 nuqta tugma -->
        <Button x:Name="DotsButton"
                Content="⋮"
                FontSize="14"
                Background="Transparent"
                BorderThickness="0"
                Padding="0"
                Margin="0"
                Click="DotsButton_Click"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Focusable="False" />

        <!-- Popup -->
        <Popup x:Name="ActionPopup"
               Placement="Center"
               PlacementTarget="{Binding ElementName=DotsButton}"
               AllowsTransparency="True"
               StaysOpen="False"
               PopupAnimation="Fade"
               HorizontalOffset="-15">

            <Border Background="#01FFFFFF">
                <StackPanel Orientation="Horizontal"
                            RenderTransformOrigin="0.5,0.5"
                            DataContext="{Binding CommandParameter, RelativeSource={RelativeSource AncestorType=UserControl}}">
                    <StackPanel.RenderTransform>
                        <TransformGroup>
                            <ScaleTransform x:Name="stackScale" ScaleX="0" ScaleY="0" />
                            <TranslateTransform x:Name="stackTranslate" X="0" />
                        </TransformGroup>
                    </StackPanel.RenderTransform>
                    
                    <!-- Edit -->
                    <Button x:Name="EditButton"
                            Content="✏️"
                            Focusable="False"
                            IsTabStop="False"
                            Click="ClosePopup_Click"
                            Style="{StaticResource ContextMenuButtonStyle}"
                            Command="{Binding EditCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                            CommandParameter="{Binding}"
                            Visibility="{Binding IsEditing, Converter={StaticResource InverseBoolToVisibilityConverter}}" />

                    <!-- Save -->
                    <Button x:Name="SaveButton"
                            Content="💾"
                            Focusable="False"
                            IsTabStop="False"
                            Click="ClosePopup_Click"
                            Style="{StaticResource ContextMenuButtonStyle}"
                            Command="{Binding SaveCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                            CommandParameter="{Binding}"
                            Visibility="{Binding IsEditing, Converter={StaticResource BoolToVisibilityConverter}}" />

                    <!-- Delete -->
                    <Button Content="🗑️"
                            Focusable="False"
                            IsTabStop="False"
                            Style="{StaticResource ContextMenuButtonStyle}"
                            Command="{Binding DeleteCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                            CommandParameter="{Binding}" />
                </StackPanel>
            </Border>
        </Popup>
    </Grid>
</UserControl>
